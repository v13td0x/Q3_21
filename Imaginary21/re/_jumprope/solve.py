from pwn import *
x = [0xFD, 0x3C, 0x0C4, 0x0E, 0x76, 0x0FF, 0x4B, 0x45, 0x1F, 0x40, 0x0F4, 0x0E6, 0x80, 0x0B8, 0x0B5, 0x0E8, 0x76, 0x8E, 0x3B, 0x0F8, 0x0E4, 0x0BD, 0x0C9, 0x0C7, 0x3F, 0x0E6, 0x0CF, 0x15, 0x94, 0x9A, 0x8A, 0x28, 0x4E, 0x5E, 0x1E, 0x3F, 0x25, 0x0D4, 0x2C, 0x0A9, 0x36, 0x28, 0x42, 0x40, 0x93, 0x8D, 0x0F, 0x0FF, 0x0AE, 0x2B, 0x2b, 0x0DF, 0x7E, 0x1A, 0x4E, 0x5, 63, 0x0D0, 0x88, 0x0E1, 0x0A1, 0x1F, 0x5A, 0x3D, 0x36, 0x4F, 0x0AE, 0x89, 0x7B, 0x0D7, 0x27, 0x0D0, 0x29, 0x0C0, 0x9E, 0x0F0, 0x20, 0x0DF, 0x69, 0x77, 0x94, 0x0E9, 0x58, 0x0F, 0x0B8, 0x0EC, 0x0F9, 0x24]

def test(n):
    if(n == 1):
        return 0
    for i in range(2, n-1, 1):
        if not (n % i):
            return 0
    return 1
def next(v):
    for i in range(8):
        v5 = 0
        v4 = v
        for j in range(8):
            if(test(j + 1)):
                v5 = v5 ^ (v4 & 1)
            v4 >>= 1
        v = (v5 << 7) + (v >> 1)
    return v
val = 2
val_list = bytearray(b'')
for i in range(88):
    val = next(val)
    val_list.append(val)

pop_rdi = 0x40148b
# correct
c = 0x401211
o = 0x40122E
r = 0x40125B
e = 0x401278
t = 0x401295
# follow above order
vars0 = p64(c)
# pass param
vars0 += p64(pop_rdi)
vars0 += p64(0x1337c0d3)
vars0 += p64(o)
vars0 += p64(r)
vars0 += p64(r)
vars0 += p64(e)
vars0 += p64(c)
# pass param
vars0 += p64(pop_rdi)
vars0 += p64(0xdeadface)
vars0 += p64(t)

flag = bytearray(b'')
for i in range(88):
    flag.append(vars0[i] ^ x[i] ^ val_list[i])
print(flag)